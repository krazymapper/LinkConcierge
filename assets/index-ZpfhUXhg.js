(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function t(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=t(r);fetch(r.href,n)}})();class m{constructor(){this.links=this.loadLinks(),this.currentFilter="",this.currentSort="date",this.init()}init(){this.setupEventListeners(),this.setupTheme(),this.renderLinks(),this.updateCategoryFilter()}loadLinks(){const e=localStorage.getItem("linkconcierge-links");return e?JSON.parse(e):[]}saveLinks(){localStorage.setItem("linkconcierge-links",JSON.stringify(this.links))}setupTheme(){const e=localStorage.getItem("linkconcierge-theme")||"light";this.setTheme(e),this.updateThemeToggle()}setTheme(e){e==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("linkconcierge-theme",e)}toggleTheme(){const e=document.documentElement.classList.contains("dark");this.setTheme(e?"light":"dark"),this.updateThemeToggle()}updateThemeToggle(){const e=document.documentElement.classList.contains("dark"),t=document.getElementById("sun-icon"),i=document.getElementById("moon-icon");e?(t.classList.remove("hidden"),i.classList.add("hidden")):(t.classList.add("hidden"),i.classList.remove("hidden"))}setupEventListeners(){document.getElementById("add-link-form").addEventListener("submit",e=>{e.preventDefault(),this.addLink()}),document.getElementById("theme-toggle").addEventListener("click",()=>{this.toggleTheme()}),document.getElementById("search-input").addEventListener("input",e=>{this.currentFilter=e.target.value,this.renderLinks()}),document.getElementById("category-filter").addEventListener("change",e=>{this.currentFilter=e.target.value,this.renderLinks()}),document.getElementById("sort-by").addEventListener("change",e=>{this.currentSort=e.target.value,this.renderLinks()}),document.getElementById("export-btn").addEventListener("click",()=>{this.exportLinks()})}addLink(){const e=document.getElementById("add-link-form"),t=new FormData(e),i=t.get("url").trim(),r=t.get("title").trim(),n=t.get("category").trim()||"G√©n√©ral",s=t.get("icon").trim()||"üîó";if(!i||!r){alert("Veuillez remplir l'URL et le titre");return}if(!this.isValidUrl(i)){alert("Veuillez entrer une URL valide");return}const o={id:Date.now().toString(),url:i,title:r,category:n,icon:s,createdAt:new Date().toISOString(),domain:this.extractDomain(i)};this.links.unshift(o),this.saveLinks(),this.renderLinks(),this.updateCategoryFilter(),e.reset(),this.showSuccessMessage("Lien ajout√© avec succ√®s !")}deleteLink(e){confirm("√ätes-vous s√ªr de vouloir supprimer ce lien ?")&&(this.links=this.links.filter(t=>t.id!==e),this.saveLinks(),this.renderLinks(),this.updateCategoryFilter())}isValidUrl(e){try{return new URL(e),!0}catch{return!1}}extractDomain(e){try{return new URL(e).hostname.replace("www.","")}catch{return"unknown"}}renderLinks(){const e=document.getElementById("links-container"),t=document.getElementById("empty-state");let i=this.filterLinks();if(i=this.sortLinks(i),i.length===0){e.innerHTML="",t.classList.remove("hidden");return}t.classList.add("hidden");const r=this.groupLinksByCategory(i);e.innerHTML=this.renderGroupedLinks(r),document.querySelectorAll(".delete-link-btn").forEach(n=>{n.addEventListener("click",s=>{const o=s.target.closest(".link-card").dataset.id;this.deleteLink(o)})})}filterLinks(){let e=this.links;if(this.currentFilter){const t=this.currentFilter.toLowerCase();e=e.filter(i=>i.title.toLowerCase().includes(t)||i.url.toLowerCase().includes(t)||i.category.toLowerCase().includes(t))}return e}sortLinks(e){return e.sort((t,i)=>{switch(this.currentSort){case"title":return t.title.localeCompare(i.title);case"category":return t.category.localeCompare(i.category);case"date":default:return new Date(i.createdAt)-new Date(t.createdAt)}})}groupLinksByCategory(e){const t={};return e.forEach(i=>{t[i.category]||(t[i.category]=[]),t[i.category].push(i)}),t}renderGroupedLinks(e){return Object.entries(e).map(([t,i])=>`
            <div class="mb-8 animate-fade-in">
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center">
                    <span class="mr-2">üìÅ</span>
                    ${t}
                    <span class="ml-2 text-sm text-gray-500 dark:text-gray-400">(${i.length})</span>
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                    ${i.map(r=>this.renderLinkCard(r)).join("")}
                </div>
            </div>
        `).join("")}renderLinkCard(e){const t=new Date(e.createdAt).toLocaleDateString("fr-FR");return`
            <div class="link-card bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4 hover:shadow-md transition-shadow animate-scale-in" data-id="${e.id}">
                <div class="flex items-start justify-between mb-3">
                    <div class="flex items-start space-x-2 flex-1 min-w-0">
                        <span class="text-2xl flex-shrink-0">${e.icon}</span>
                        <div class="flex-1 min-w-0">
                            <h4 class="text-sm font-medium text-gray-900 dark:text-white truncate leading-tight">
                                ${this.escapeHtml(e.title)}
                            </h4>
                            <p class="text-xs text-gray-500 dark:text-gray-400 truncate mt-1">
                                ${this.escapeHtml(e.domain)}
                            </p>
                        </div>
                    </div>
                    <button class="delete-link-btn text-gray-400 hover:text-red-500 transition-colors p-1 flex-shrink-0 ml-2" title="Supprimer">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                        </svg>
                    </button>
                </div>
                
                <a href="${this.escapeHtml(e.url)}" target="_blank" rel="noopener noreferrer"
                   class="block text-sm text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 truncate mb-2">
                    ${this.escapeHtml(e.url)}
                </a>
                
                <div class="flex items-center justify-between text-xs text-gray-500 dark:text-gray-400">
                    <span class="truncate">${t}</span>
                    <span class="px-2 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-xs flex-shrink-0 ml-2">
                        ${this.escapeHtml(e.category)}
                    </span>
                </div>
            </div>
        `}updateCategoryFilter(){const e=[...new Set(this.links.map(r=>r.category))].sort(),t=document.getElementById("category-filter"),i=t.value;t.innerHTML='<option value="">Toutes les cat√©gories</option>',e.forEach(r=>{const n=document.createElement("option");n.value=r,n.textContent=r,t.appendChild(n)}),e.includes(i)&&(t.value=i)}exportLinks(){const e={links:this.links,exportedAt:new Date().toISOString(),version:"1.0"},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),i=URL.createObjectURL(t),r=document.createElement("a");r.href=i,r.download=`linkconcierge-export-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(i),this.showSuccessMessage("Export termin√© !")}escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}showSuccessMessage(e){const t=document.createElement("div");t.className="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-md shadow-lg z-50 animate-fade-in",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.remove()},3e3)}}document.addEventListener("DOMContentLoaded",()=>{new m});if(window.location.pathname.endsWith("blog.html")){let c=function(){return JSON.parse(localStorage.getItem("blogArticles")||"[]")},e=function(r){localStorage.setItem("blogArticles",JSON.stringify(r))},t=function(){const r=c().sort((s,o)=>new Date(o.date)-new Date(s.date)),n=document.getElementById("articles-list");if(n){if(r.length===0){n.innerHTML='<p class="text-gray-500 dark:text-gray-400">Aucun article publi√© pour le moment.</p>';return}n.innerHTML=r.map((s,o)=>`
      <article class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 shadow-sm relative group">
        <h3 class="text-lg font-bold text-gray-900 dark:text-white mb-2">${i(s.title)}</h3>
        <div class="prose prose-sm dark:prose-invert max-w-none mb-2">${s.html}</div>
        <div class="flex items-center justify-between text-xs text-gray-500 dark:text-gray-400">
          <span>${new Date(s.date).toLocaleString()}</span>
          <div class="space-x-2 opacity-80 group-hover:opacity-100">
            <button class="edit-article px-2 py-1 rounded bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-200 hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors" data-idx="${o}">√âditer</button>
            <button class="delete-article px-2 py-1 rounded bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-200 hover:bg-red-200 dark:hover:bg-red-800 transition-colors" data-idx="${o}">Supprimer</button>
          </div>
        </div>
      </article>
    `).join(""),n.querySelectorAll(".delete-article").forEach(s=>{s.addEventListener("click",function(){if(confirm("Supprimer cet article ?")){const o=parseInt(this.dataset.idx),a=c();a.splice(o,1),e(a),t()}})}),n.querySelectorAll(".edit-article").forEach(s=>{s.addEventListener("click",function(){const o=parseInt(this.dataset.idx),l=c()[o];document.getElementById("article-title").value=l.title,document.getElementById("article-content").value=l.content,document.getElementById("publish-article").textContent="Mettre √† jour",document.getElementById("publish-article").dataset.editIdx=o,window.scrollTo({top:0,behavior:"smooth"})})})}},i=function(r){return r.replace(/[&<>"']/g,function(n){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[n]})};var h=c,p=e,f=t,v=i;document.querySelectorAll(".format-btn").forEach(r=>{r.addEventListener("click",function(){const n=document.getElementById("article-content"),s=this.dataset.format,[o,a]=[n.selectionStart,n.selectionEnd];let l=n.value.substring(0,o),d=n.value.substring(o,a),u=n.value.substring(a);s==="bold"?n.value=l+"**"+d+"**"+u:s==="italic"?n.value=l+"*"+d+"*"+u:s==="h2"?n.value=l+`
## `+d+`
`+u:s==="ul"&&(n.value=l+`
- `+d+`
`+u),n.focus(),n.setSelectionRange(o+2,a+2)})}),document.getElementById("publish-article").addEventListener("click",function(){const r=document.getElementById("article-title").value.trim(),n=document.getElementById("article-content").value.trim();if(!r||!n){alert("Veuillez remplir le titre et le contenu.");return}let s=n.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/^## (.*)$/gm,"<h2>$1</h2>").replace(/^- (.*)$/gm,"<ul><li>$1</li></ul>").replace(/\n/g,"<br>");s=s.replace(/<\/ul><br><ul>/g,"");const o=c(),a=this.dataset.editIdx;if(a!==void 0)o[a]={...o[a],title:r,content:n,html:s,date:new Date().toISOString()},delete this.dataset.editIdx,this.textContent="Publier";else{const l={title:r,content:n,html:s,date:new Date().toISOString()};o.push(l)}e(o),document.getElementById("article-title").value="",document.getElementById("article-content").value="",t()}),t()}class g{constructor(){this.deferredPrompt=null,this.init()}init(){this.registerServiceWorker(),this.setupInstallPrompt(),this.checkForUpdates()}async registerServiceWorker(){if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.register("./sw.js",{scope:"./"});console.log("Service Worker registered successfully:",e),e.addEventListener("updatefound",()=>{const t=e.installing;t.addEventListener("statechange",()=>{t.state==="installed"&&navigator.serviceWorker.controller&&this.showUpdateNotification()})})}catch(e){console.error("Service Worker registration failed:",e)}}setupInstallPrompt(){window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),this.deferredPrompt=e,this.showInstallButton()}),window.addEventListener("appinstalled",()=>{console.log("PWA was installed"),this.deferredPrompt=null,this.hideInstallButton()})}showInstallButton(){if(!document.getElementById("install-btn")){const e=document.createElement("button");e.id="install-btn",e.className="px-4 py-2 text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 rounded-md transition-colors",e.innerHTML="üì± Installer l'app",e.addEventListener("click",()=>this.installApp());const t=document.getElementById("export-btn");t.parentNode.insertBefore(e,t.nextSibling)}}hideInstallButton(){const e=document.getElementById("install-btn");e&&e.remove()}async installApp(){if(this.deferredPrompt){this.deferredPrompt.prompt();const{outcome:e}=await this.deferredPrompt.userChoice;console.log(e==="accepted"?"User accepted the install prompt":"User dismissed the install prompt"),this.deferredPrompt=null,this.hideInstallButton()}}showUpdateNotification(){const e=document.createElement("div");e.className="fixed bottom-4 right-4 bg-blue-500 text-white px-4 py-2 rounded-md shadow-lg z-50 animate-fade-in",e.innerHTML=`
            <div class="flex items-center space-x-2">
                <span>üîÑ Nouvelle version disponible</span>
                <button onclick="location.reload()" class="text-sm underline">Actualiser</button>
            </div>
        `,document.body.appendChild(e),setTimeout(()=>{e.remove()},1e4)}checkForUpdates(){"serviceWorker"in navigator&&navigator.serviceWorker.getRegistration().then(e=>{e&&e.update()})}}document.addEventListener("DOMContentLoaded",()=>{new g});
