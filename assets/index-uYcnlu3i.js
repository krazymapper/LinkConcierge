(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();class p{constructor(){this.links=this.loadLinks(),this.currentFilter="",this.currentSort="date",this.init()}init(){this.setupEventListeners(),this.setupTheme(),this.renderLinks(),this.updateCategoryFilter()}loadLinks(){const e=localStorage.getItem("linkconcierge-links");return e?JSON.parse(e):[]}saveLinks(){localStorage.setItem("linkconcierge-links",JSON.stringify(this.links))}setupTheme(){const e=localStorage.getItem("linkconcierge-theme")||"light";this.setTheme(e),this.updateThemeToggle()}setTheme(e){e==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("linkconcierge-theme",e)}toggleTheme(){const e=document.documentElement.classList.contains("dark");this.setTheme(e?"light":"dark"),this.updateThemeToggle()}updateThemeToggle(){const e=document.documentElement.classList.contains("dark"),t=document.getElementById("sun-icon"),n=document.getElementById("moon-icon");e?(t.classList.remove("hidden"),n.classList.add("hidden")):(t.classList.add("hidden"),n.classList.remove("hidden"))}setupEventListeners(){document.getElementById("add-link-form").addEventListener("submit",t=>{t.preventDefault(),this.addLink()}),document.getElementById("theme-toggle").addEventListener("click",()=>{this.toggleTheme()}),document.getElementById("search-input").addEventListener("input",t=>{this.currentFilter=t.target.value,this.renderLinks()}),document.getElementById("category-filter").addEventListener("change",t=>{this.currentFilter=t.target.value,this.renderLinks()}),document.getElementById("sort-by").addEventListener("change",t=>{this.currentSort=t.target.value,this.renderLinks()}),document.getElementById("export-btn").addEventListener("click",()=>{this.exportLinks()});const e=document.getElementById("test-data-btn");e&&e.addEventListener("click",()=>{const t=[{id:Date.now().toString(),url:"https://github.com",title:"GitHub - Where the world builds software",category:"D√©veloppement",icon:"üêô",createdAt:new Date().toISOString(),domain:"github.com"},{id:(Date.now()+1).toString(),url:"https://stackoverflow.com",title:"Stack Overflow - Where Developers Learn, Share, & Build Careers",category:"D√©veloppement",icon:"üíª",createdAt:new Date().toISOString(),domain:"stackoverflow.com"},{id:(Date.now()+2).toString(),url:"https://developer.mozilla.org",title:"MDN Web Docs - Learn web development",category:"Documentation",icon:"üìö",createdAt:new Date().toISOString(),domain:"developer.mozilla.org"}];this.links.unshift(...t),this.saveLinks(),this.renderLinks(),this.updateCategoryFilter(),this.showToast("Donn√©es de test ajout√©es !")})}addLink(){const e=document.getElementById("add-link-form"),t=new FormData(e),n=t.get("url").trim(),i=t.get("title").trim(),r=t.get("category").trim()||"G√©n√©ral",s=t.get("icon").trim()||"üîó";if(!n||!i){alert("Veuillez remplir l'URL et le titre");return}if(!this.isValidUrl(n)){alert("Veuillez entrer une URL valide");return}const o={id:Date.now().toString(),url:n,title:i,category:r,icon:s,createdAt:new Date().toISOString(),domain:this.extractDomain(n)};this.links.unshift(o),this.saveLinks(),this.renderLinks(),this.updateCategoryFilter(),e.reset(),this.showToast("Lien ajout√© avec succ√®s !")}deleteLink(e){confirm("√ätes-vous s√ªr de vouloir supprimer ce lien ?")&&(this.links=this.links.filter(t=>t.id!==e),this.saveLinks(),this.renderLinks(),this.updateCategoryFilter(),this.showToast("Lien supprim√©."))}isValidUrl(e){try{return new URL(e),!0}catch{return!1}}extractDomain(e){try{return new URL(e).hostname.replace("www.","")}catch{return"unknown"}}renderLinks(){const e=document.getElementById("links-container"),t=document.getElementById("empty-state");let n=this.filterLinks();if(n=this.sortLinks(n),n.length===0){e.innerHTML="",this.renderEmptyState();return}t.classList.add("hidden");const i=this.groupLinksByCategory(n);e.innerHTML=this.renderGroupedLinks(i),document.querySelectorAll(".delete-link-btn").forEach(r=>{r.addEventListener("click",s=>{const o=s.target.closest(".link-card").dataset.id;this.deleteLink(o)})})}filterLinks(){let e=this.links;if(this.currentFilter){const t=this.currentFilter.toLowerCase();e=e.filter(n=>n.title.toLowerCase().includes(t)||n.url.toLowerCase().includes(t)||n.category.toLowerCase().includes(t))}return e}sortLinks(e){return e.sort((t,n)=>{switch(this.currentSort){case"title":return t.title.localeCompare(n.title);case"category":return t.category.localeCompare(n.category);case"date":default:return new Date(n.createdAt)-new Date(t.createdAt)}})}groupLinksByCategory(e){const t={};return e.forEach(n=>{t[n.category]||(t[n.category]=[]),t[n.category].push(n)}),t}renderGroupedLinks(e){return Object.entries(e).map(([t,n])=>`
            <div class="mb-8 animate-fade-in">
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center">
                    <span class="mr-2">üìÅ</span>
                    ${t}
                    <span class="ml-2 text-sm text-gray-500 dark:text-gray-400">(${n.length})</span>
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                    ${n.map(i=>this.renderLinkCard(i)).join("")}
                </div>
            </div>
        `).join("")}renderLinkCard(e){const t=new Date(e.createdAt).toLocaleDateString();return`
            <div class="bg-slate-900 border border-slate-700 rounded-lg shadow-sm p-4 flex flex-col gap-2 transition hover:shadow-lg">
                <div class="flex items-center gap-2 mb-1">
                    <span class="text-2xl">${this.escapeHtml(e.icon||"üîó")}</span>
                    <a href="${this.escapeHtml(e.url)}" target="_blank" rel="noopener" class="text-lg font-semibold text-emerald-500 hover:underline truncate" title="${this.escapeHtml(e.title)}">
                        ${this.escapeHtml(e.title)}
                    </a>
                </div>
                <div class="flex items-center justify-between text-xs">
                    <span class="text-slate-400">${t}</span>
                    <span class="px-2 py-1 bg-slate-800 text-emerald-500 border border-emerald-500 rounded-full text-xs ml-2">
                        ${this.escapeHtml(e.category)}
                    </span>
                </div>
                <div class="flex gap-2 mt-2">
                    <button class="px-3 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-md text-xs font-medium transition-colors active:scale-95 focus:outline-none" data-action="edit" data-id="${e.id}" aria-label="√âditer le lien ${this.escapeHtml(e.title)}">√âditer</button>
                    <button class="px-3 py-2 bg-slate-800 hover:bg-emerald-600 text-emerald-500 border border-emerald-500 rounded-md text-xs font-medium transition-colors active:scale-95 focus:outline-none" data-action="delete" data-id="${e.id}" aria-label="Supprimer le lien ${this.escapeHtml(e.title)}">Supprimer</button>
                </div>
            </div>
        `}updateCategoryFilter(){const e=[...new Set(this.links.map(i=>i.category))].sort(),t=document.getElementById("category-filter"),n=t.value;t.innerHTML='<option value="">Toutes les cat√©gories</option>',e.forEach(i=>{const r=document.createElement("option");r.value=i,r.textContent=i,t.appendChild(r)}),e.includes(n)&&(t.value=n)}exportLinks(){const e={links:this.links,exportedAt:new Date().toISOString(),version:"1.0"},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),n=URL.createObjectURL(t),i=document.createElement("a");i.href=n,i.download=`linkconcierge-export-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n),this.showToast("Export termin√© !")}escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}showToast(e){let t=document.getElementById("toast-feedback");t||(t=document.createElement("div"),t.id="toast-feedback",t.className="fixed left-1/2 bottom-8 -translate-x-1/2 bg-emerald-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 text-base font-semibold animate-fade-in",document.body.appendChild(t)),t.textContent=e,t.classList.remove("hidden"),setTimeout(()=>{t.classList.add("hidden")},2e3)}renderEmptyState(){const e=document.getElementById("empty-state");e&&(e.innerHTML=`
                <div class="text-emerald-500 text-6xl mb-4">üîó</div>
                <h3 class="text-lg font-medium text-emerald-500 mb-2">Aucun lien sauvegard√©</h3>
                <p class="text-slate-400">Commencez par ajouter votre premier lien ci-dessus !</p>
            `,e.classList.remove("hidden"))}}document.addEventListener("DOMContentLoaded",()=>{(window.location.pathname.endsWith("index.html")||window.location.pathname.endsWith("/"))&&new p;const a=document.querySelector("header");a&&a.classList.add("sticky","top-0","z-40")});if(window.location.pathname.includes("blog.html")){let a=function(){return JSON.parse(localStorage.getItem("blogArticles")||"[]")},e=function(r){localStorage.setItem("blogArticles",JSON.stringify(r))},t=function(r){return r.replace(/[&<>"']/g,function(s){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[s]})},n=function(){const r=a().sort((o,l)=>new Date(l.date)-new Date(o.date)),s=document.getElementById("articles-list");if(s){if(r.length===0){s.innerHTML='<p class="text-slate-400">Aucun article publi√© pour le moment.</p>';return}s.innerHTML=r.map((o,l)=>`
            <article class="bg-slate-900 border border-slate-700 rounded-lg p-4 shadow-sm relative group">
                <h3 class="text-lg font-bold text-emerald-500 mb-2">${t(o.title)}</h3>
                <div class="prose prose-sm prose-invert max-w-none mb-2">${o.html}</div>
                <div class="flex items-center justify-between text-xs text-slate-400">
                    <span>${new Date(o.date).toLocaleString("fr-FR")}</span>
                    <div class="space-x-2 opacity-80 group-hover:opacity-100">
                        <button class="edit-article px-2 py-1 rounded bg-blue-600 hover:bg-blue-700 text-white transition-colors" data-idx="${l}">√âditer</button>
                        <button class="delete-article px-2 py-1 rounded bg-red-600 hover:bg-red-700 text-white transition-colors" data-idx="${l}">Supprimer</button>
                    </div>
                </div>
            </article>
        `).join(""),s.querySelectorAll(".delete-article").forEach(o=>{o.addEventListener("click",function(){if(confirm("Supprimer cet article ?")){const l=parseInt(this.dataset.idx),d=a();d.splice(l,1),e(d),n()}})}),s.querySelectorAll(".edit-article").forEach(o=>{o.addEventListener("click",function(){const l=parseInt(this.dataset.idx),c=a()[l];document.getElementById("article-title").value=c.title,document.getElementById("article-content").value=c.content,document.getElementById("publish-article").textContent="Mettre √† jour",document.getElementById("publish-article").dataset.editIdx=l,window.scrollTo({top:0,behavior:"smooth"})})})}};var g=a,f=e,v=t,b=n;document.querySelectorAll(".format-btn").forEach(r=>{r.addEventListener("click",function(){const s=document.getElementById("article-content"),o=this.dataset.format,[l,d]=[s.selectionStart,s.selectionEnd];let c=s.value.substring(0,l),u=s.value.substring(l,d),m=s.value.substring(d);o==="bold"?s.value=c+"**"+u+"**"+m:o==="italic"?s.value=c+"*"+u+"*"+m:o==="h2"?s.value=c+`
## `+u+`
`+m:o==="ul"&&(s.value=c+`
- `+u+`
`+m),s.focus(),s.setSelectionRange(l+2,d+2)})});const i=document.getElementById("publish-article");i&&i.addEventListener("click",function(){const r=document.getElementById("article-title").value.trim(),s=document.getElementById("article-content").value.trim();if(!r||!s){alert("Veuillez remplir le titre et le contenu.");return}let o=s.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/^## (.*)$/gm,'<h2 class="text-lg font-semibold text-slate-100 mt-4 mb-2">$1</h2>').replace(/^- (.*)$/gm,"<li>$1</li>").replace(/\n/g,"<br>");o=o.replace(/(<li>.*?<\/li>)/gs,'<ul class="list-disc pl-6 mb-2">$1</ul>'),o=o.replace(/<\/ul><br><ul>/g,"");const l=a(),d=this.dataset.editIdx;if(d!==void 0)l[d]={...l[d],title:r,content:s,html:o,date:new Date().toISOString()},delete this.dataset.editIdx,this.textContent="Publier";else{const u={title:r,content:s,html:o,date:new Date().toISOString()};l.push(u)}e(l),document.getElementById("article-title").value="",document.getElementById("article-content").value="",n();const c=document.createElement("div");c.className="fixed left-1/2 bottom-8 -translate-x-1/2 bg-emerald-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 text-base font-semibold",c.textContent=d!==void 0?"Article mis √† jour !":"Article publi√© !",document.body.appendChild(c),setTimeout(()=>{c.remove()},2e3)}),n()}(function(){const a=document.createElement("button");a.id="scroll-to-top",a.setAttribute("aria-label","Remonter en haut de page"),a.className="fixed bottom-6 right-4 z-50 bg-emerald-500 text-white rounded-full p-3 shadow-lg transition-all hover:bg-emerald-600 active:scale-95",a.innerHTML='<svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 15l7-7 7 7"/></svg>',a.style.display="none",document.body.appendChild(a),a.addEventListener("click",()=>window.scrollTo({top:0,behavior:"smooth"})),window.addEventListener("scroll",()=>{a.style.display=window.scrollY>200?"block":"none"})})();class h{constructor(){this.deferredPrompt=null,this.init()}init(){this.registerServiceWorker(),this.setupInstallPrompt(),this.checkForUpdates()}async registerServiceWorker(){if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.register("./sw.js",{scope:"./"});console.log("Service Worker registered successfully:",e),e.addEventListener("updatefound",()=>{const t=e.installing;t.addEventListener("statechange",()=>{t.state==="installed"&&navigator.serviceWorker.controller&&this.showUpdateNotification()})})}catch(e){console.error("Service Worker registration failed:",e)}}setupInstallPrompt(){window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),this.deferredPrompt=e,this.showInstallButton()}),window.addEventListener("appinstalled",()=>{console.log("PWA was installed"),this.deferredPrompt=null,this.hideInstallButton()})}showInstallButton(){if(!document.getElementById("install-btn")){const e=document.createElement("button");e.id="install-btn",e.className="px-4 py-2 text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 rounded-md transition-colors",e.innerHTML="üì± Installer l'app",e.addEventListener("click",()=>this.installApp());const t=document.getElementById("export-btn");t.parentNode.insertBefore(e,t.nextSibling)}}hideInstallButton(){const e=document.getElementById("install-btn");e&&e.remove()}async installApp(){if(this.deferredPrompt){this.deferredPrompt.prompt();const{outcome:e}=await this.deferredPrompt.userChoice;console.log(e==="accepted"?"User accepted the install prompt":"User dismissed the install prompt"),this.deferredPrompt=null,this.hideInstallButton()}}showUpdateNotification(){const e=document.createElement("div");e.className="fixed bottom-4 right-4 bg-blue-500 text-white px-4 py-2 rounded-md shadow-lg z-50 animate-fade-in",e.innerHTML=`
            <div class="flex items-center space-x-2">
                <span>üîÑ Nouvelle version disponible</span>
                <button onclick="location.reload()" class="text-sm underline">Actualiser</button>
            </div>
        `,document.body.appendChild(e),setTimeout(()=>{e.remove()},1e4)}checkForUpdates(){"serviceWorker"in navigator&&navigator.serviceWorker.getRegistration().then(e=>{e&&e.update()})}}document.addEventListener("DOMContentLoaded",()=>{new h});
